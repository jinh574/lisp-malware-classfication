(reset-kb)

(disable-slot-checking)       ; (Temporarily disable while rebuilding KB state)
                              ; (Will be restored to original value by final SETQ statements)

(disable-classification)      ; (Temporarily disable while rebuilding KB state)
                              ; (Will be restored to original value by final SETQ statements)

(disable-installing-inverses) ; (Temporarily disable while rebuilding KB state)
                              ; (Will be switched back on by (enable-installing-inverses) at the end)

;;; ----------- TAXONOMY -----------

;;; (Concept Number is a build-in class)

(파일 
	has (superclasses (행동))
	(실행 (*생성 *삭제 *정보수정 *바이너리수정 *권한수정 *읽기))
	(경로 (nil))
	(이름 (nil)))

(프로세스
	has (superclasses (행동))
	(실행 (*생성 *종료 *일시정지 *시작))
	(경로 (nil))
	(이름 (nil)))

(레지스트리
	has (superclasses (행동))
	(실행 (*생성 *삭제 *값수정 *권한수정))
	(경로 (nil))
	(이름 (nil)))

(서비스
	has (superclasses (행동))
	(실행 (*등록 *제거 *시작 *종료))
	(경로 (nil))
	(이름 (nil)))

(소켓
	has (superclasses (행동))
	(실행 (*열기 *닫기 *전송))
	(포트 (nil))
	(대상 (nil)))

(후킹
	has (superclasses (행동))
	(실행 (*IAT *EAT *Inline))
	(점프대상 (nil))
	(후킹대상 (nil))

(코드
	has (superclasses (행동))
	(실행 (*삽입 *암호화라이브러리)))

(부트
	has (superclasses (행동))
	(실행 (*MBR)))

(네트워크
	has (superclasses (행동))
	(실행 (*DNS *프록시 *NDIS)))

;;; ----------- CONTENTS -----------

(*KILLAV has
	(superclasses (악성코드))
	(판단조건 (
				(a 서비스 with (실행 (*종료)))
				(a 후킹 with (실행 (*Inline)))
				(a 부트 with (실행 (*MBR))))
	)
	(임시 (
		(condService == (allof ?x in (the 판단조건 of Self) where ((?x isa 서비스) and ((the 실행 of ?x) = *종료))))
		(condHooking == (allof ?x in (the 판단조건 of Self) where ((?x isa 후킹) and ((the 실행 of ?x) = *Inline))))
		(condBoot == (allof ?x in (the 판단조건 of Self) where ((?x isa 부트) and ((the 실행 of ?x) = *MBR))))
		)
	
	)
	(결과 ((if ((the 실행 of (the 임시 of Self)) /= NIL) then true else false)))
)
